# 特征
## 时频域特征（Time-Frequency Domain Features）

### 1. 峰峰值均值（Peak-Peak Mean）
**描述**：时间序列中峰（最大值）与谷（最小值）之间垂直长度的算术平均值。  
**计算公式**：  
$$
\text{Peak-Peak Mean} = \frac{1}{N} \sum_{i=1}^{N} (x_{\text{max},i} - x_{\text{min},i})
$$  
其中，$x_{\text{max},i}$ 和 $x_{\text{min},i}$ 为第 $i$ 个时间窗口内的最大和最小值，$N$ 为窗口数。

---

### 2. 均方值（Mean Square Value）
**描述**：时间序列平方值的算术平均。  
**计算公式**：  
$$
\text{Mean Square Value} = \frac{1}{T} \sum_{t=1}^{T} x(t)^2
$$  
其中，$T$ 为时间序列长度，$x(t)$ 为信号在时间点 $t$ 的值。

---

### 3. 方差（Variance）
**描述**：反映时间序列的离散程度。  
**计算公式**：  
$$
\text{Variance} = \frac{1}{T} \sum_{t=1}^{T} \left( x(t) - \mu \right)^2
$$  
其中，$\mu$ 为时间序列的均值。

---

### 4. Hjorth参数：活动性（Activity）
**描述**：活动性参数反映信号功率信息，等同于方差。  
**计算公式**：  
$$
\text{Activity} = \text{Var}(x)
$$

---

### 5. Hjorth参数：移动性（Mobility）
**描述**：估计信号的平均频率，定义为方差的一阶导数与原始方差的平方根之比。  
**计算公式**：  
$$
\text{Mobility} = \sqrt{\frac{\text{Var}(x')}{\text{Var}(x)}}
$$  
其中，$x'$ 为信号的一阶差分。

---

### 6. Hjorth参数：复杂性（Complexity）
**描述**：反映信号频率变化的复杂度，定义为移动性参数的导数与移动性的比值。  
**计算公式**：  
$$
\text{Complexity} = \frac{\text{Mobility}(x')}{\text{Mobility}(x)}
$$

---

### 7. 最大功率谱频率（Maximum Power Spectral Frequency）
**描述**：通过傅里叶变换将时间序列转换到频域后功率谱密度最大的频率值。  
**计算步骤**：  
1. 对信号进行傅里叶变换得到功率谱 $P(f)$。  
2. 找到 $P(f)$ 最大值对应的频率 $f_{\text{max}}$。  

---

### 8. 最大功率谱密度（Maximum Power Spectral Density）
**描述**：通过傅里叶变换将时间序列转换到频域后功率谱中的最大值，反映信号在频域的能量峰值。  
**计算公式**：  
$$
\text{Max PSD} = \max(P(f))
$$

---

### 9. 功率总和（Power Sum）
**描述**：通过傅里叶变换将时间序列转换到频域后,所有频率分量的功率之和。  
**计算公式**：  
$$
\text{Power Sum} = \sum_{f} P(f)
$$

---

## 非线性动态系统特征（Non-linear Dynamical System Features）

### 10. 近似熵（Approximate Entropy, ApEn）
**描述**：衡量时间序列的规律性，值越小表示信号越规则。  
**计算公式**（简化为两参数 $m$ 和 $r$ 的版本）：  
$$
\text{ApEn}(m, r) = \phi^m(r) - \phi^{m+1}(r)
$$  
其中，$\phi^m(r)$ 表示长度为 $m$ 的向量在容限 $r$ 下的相似性度量。

---

### 11. C0复杂性（C0 Complexity）
**描述**：衡量信号中随机成分的比例。  
**计算公式**：  
1. 将信号分解为规则部分 $x_{\text{reg}}$ 和随机部分 $x_{\text{sto}}$。  
2. 计算随机部分能量占比：  
$$
\text{C0} = \frac{\|x_{\text{sto}}\|^2}{\|x\|^2}
$$

---

### 12. 相关维（Correlation Dimension）
**描述**：决定了能够描述系统动态的维度（自变量）数量，反映了过程的复杂性以及系统状态在相空间中的分布情况。
**计算公式**：  
$$
D_{\text{corr}} = \lim_{r \to 0} \frac{\log C(r)}{\log r}
$$  
其中，$C(r)$ 为关联积分，表示距离小于 $r$ 的向量对比例。

---

### 13. Lyapunov指数（Lyapunov Exponent）
**描述**：李雅普诺夫指数用于衡量混沌系统的非周期动态。该特征能够捕捉系统初始状态在相空间中的分离和演化情况。衡量混沌系统中邻近轨道的指数发散率。  
**计算公式**（最大Lyapunov指数）：  
$$
\lambda = \lim_{t \to \infty} \frac{1}{t} \ln \frac{\|\delta x(t)\|}{\|\delta x(0)\|}
$$  
其中，$\delta x(t)$ 为初始扰动的演化。

---

### 14. Kolmogorov熵（Kolmogorov Entropy）
**描述**：柯尔莫哥洛夫熵也是一种衡量混沌程度的指标，用于度量系统产生信息的速率以及系统丢失信息的速率，与混沌程度正相关。  
**计算方式**：通过相空间重构估计熵率。

---

### 15. 排列熵（Permutation Entropy, PE）
**描述**：基于符号动力学，将时间序列映射为符号序列后计算熵。  
**计算步骤**：  
1. 将时间序列划分为长度为 $m$ 的窗口，生成符号序列。  
2. 计算符号排列的概率分布 $P(\pi)$。  
3. 计算熵：  
$$
\text{PE} = -\sum_{\pi} P(\pi) \log P(\pi)
$$

---

### 16. 奇异谱熵（Singular Spectrum Entropy）
**描述**：通过SVD分解轨迹矩阵，计算奇异值的熵。  
**计算步骤**：  
1. 重构轨迹矩阵 $X$。  
2. 对 $X$ 进行SVD分解，得到奇异值 $\sigma_i$。  
3. 计算归一化奇异值 $p_i = \sigma_i / \sum \sigma_i$。  
4. 熵计算：  
$$
\text{SSE} = -\sum p_i \log p_i
$$

---

### 17. Shannon熵（Shannon Entropy）
**描述**：经典信息熵，衡量时间序列的不确定性。  
**计算公式**：  
$$
H = -\sum_{i} p(x_i) \log p(x_i)
$$  
其中，$p(x_i)$ 为信号值 $x_i$ 的概率分布。

---

### 18. 功率谱熵（Power Spectral Entropy）
**描述**：基于功率谱的Shannon熵，反映频谱复杂性。  
**计算步骤**：  
1. 计算功率谱 $P(f)$。  
2. 归一化功率谱：$\tilde{P}(f) = P(f) / \sum P(f)$。  
3. 熵计算：  
$$
\text{Power Spectral Entropy} = -\sum \tilde{P}(f) \log \tilde{P}(f)
$$

# 自动特征选择
## 1. 卡方检验（Chi-Squared Test, χ²）
### 核心原理
- ​**统计假设检验**：评估特征与目标变量的独立性，卡方值越高，特征与类别相关性越强。
- ​**数学公式**：
  $$
  \chi^2 = \sum_{i=1}^r \sum_{j=1}^c \frac{(O_{i,j} - E_{i,j})^2}{E_{i,j}}
  $$
  - $O_{i,j}$：特征类别$i$与目标类别$j$的观测频数  
  - $E_{i,j}$：假设独立时的期望频数（$E_{i,j} = \frac{\text{行合计} \times \text{列合计}}{\text{总样本数}}$）

### 在EEG中的应用
- ​**适用场景**：离散型特征（如分箱后的功率谱值）与分类标签（正/负情绪）。
- ​**优点**：计算高效，适合初步筛选。
- ​**缺点**：忽略特征间交互，需离散化连续型EEG特征。

---

## 2. 互信息（Mutual Information, MI）
### 核心原理
- ​**信息论度量**：量化特征与目标变量之间的信息共享程度。
- ​**数学公式**：
  $$
  I(X;Y) = \sum_{x,y} P(x,y) \log \frac{P(x,y)}{P(x)P(y)}
  $$
  - $H(X)$：特征$X$的熵  
  - $H(Y)$：目标$Y$的熵  
  - $H(X,Y)$：联合熵

### 在EEG中的应用
- ​**适用场景**：捕捉非线性关系（如脑电节律与情绪的复杂关联）。
- ​**优点**：无需线性假设，可处理连续/离散变量。
- ​**缺点**：计算复杂度高，需核密度估计。

---

## 3. ANOVA F值（ANOVA F-Value）
### 核心原理
- ​**方差分析**：通过组间方差与组内方差的比值（F值）衡量特征区分能力。
- ​**数学公式**：
  $$
  F_{\text{ratio}} = \frac{\sigma_{\text{between}}^2}{\sigma_{\text{within}}^2}
  $$
  - $\sigma_{\text{between}}^2$：不同情绪类别的均值差异  
  - $\sigma_{\text{within}}^2$：同类情绪的样本方差

### 在EEG中的应用
- ​**适用场景**：连续型EEG特征（如Hjorth参数）与分类目标。
- ​**优点**：保留特征原始分布，无需离散化。
- ​**缺点**：仅适用于线性可分问题。

---

## 4. 递归特征消除（Recursive Feature Elimination, RFE）
### 核心原理
- ​**包装式方法**：基于分类器权重递归剔除最不重要特征。
- ​**算法流程**：
  1. 训练分类器（如线性SVM），按权重$\|w\|$排序特征。
  2. 剔除权重最低的k个特征。
  3. 重复直至保留目标特征数。

### 在EEG中的应用
- ​**实验设置**：论文中使用线性SVM，逐步剔除10%特征（DEAP：2304→230步；SEED：4464→446步）。
- ​**优点**：考虑特征交互，精度高。
- ​**缺点**：计算成本高，依赖分类器选择。

---

## 5. L1正则化（L1-Norm Penalty）
### 核心原理
- ​**嵌入式方法**：在分类器目标函数中加入L1惩罚项，诱导稀疏权重。
- ​**数学公式**：
  $$
  \min_{\omega_0, \omega} \sum_{i=1}^n \left[1 - y_i(\omega_0 + \omega^T x_i)\right]_+ + C \|\omega\|_1
  $$
  - $\|\omega\|_1$：权重向量的L1范数  
  - $C$：正则化强度（论文中C∈[0.01,1]）

### 在EEG中的应用
- ​**优势场景**：高维EEG数据（如SEED的4464维），自动去除冗余特征。
- ​**优点**：高效，适合实时系统；隐式特征选择。
- ​**缺点**：可能过度稀疏，忽略弱相关特征。

---

## 方法对比与论文结论
| 方法          | 类型       | 计算效率 | 特征交互 | 适用场景               | 论文最佳表现        |
|---------------|------------|----------|----------|------------------------|---------------------|
| 卡方检验      | 过滤式     | 高       | 无       | 初步筛选               | DEAP: 57.73%        |
| 互信息        | 过滤式     | 中       | 无       | 非线性关系             | SEED: 81.33%        |
| ANOVA F值     | 过滤式     | 高       | 无       | 线性可分问题           | DEAP: 57.89%        |
| RFE           | 包装式     | 低       | 有       | 高精度需求             | SEED: ​**83.33%**    |
| L1正则化      | 嵌入式     | 中       | 有       | 高维数据实时处理       | DEAP: ​**59.06%**    |

**论文结论**：  
- ​**L1正则化**综合性能最优（DEAP AUC=0.605，SEED AUC=0.904），兼顾效率与效果。  
- ​**RFE**在SEED数据集上达到最高准确率（83.33%），但计算成本较高。  
- ​**线性特征**​（如Hjorth参数）整体优于非线性，推荐用于实时系统设计。
- 线性特征整体显著优于非线性    Hjorth参数中的 ​Mobility（No.5）​ 和 ​Complexity（No.6）​，以及 ​最大功率谱频率（No.7）​ 在Beta节律表现最优（SEED准确率>80%）。